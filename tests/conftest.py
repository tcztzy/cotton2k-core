import json
from pathlib import Path

from pytest import fixture

from cotton2k.core import run
from cotton2k.core.simulation import Simulation


@fixture
def empty_json(tmp_path: Path) -> Path:
    empty = tmp_path / "empty.cotton2k.json"
    empty.write_text(json.dumps({}))
    return empty


@fixture
def test_json(tmp_path: Path) -> Path:
    test = tmp_path / "alaer.cotton2k.json"
    test.write_text(
        json.dumps(
            {
                "description": "HAZOR 1984 experiment, treatment KB1",
                "start_date": "1984-04-01",
                "stop_date": "1984-09-28",
                "emerge_date": "1984-04-08",
                "longitude": 35,
                "latitude": 32,
                "elevation": 50,
                "site_parameters": [
                    0,
                    1.0,
                    4.0,
                    2.0,
                    0.216,
                    20,
                    24,
                    110,
                    1.0,
                    24,
                    4.0,
                    180,
                    -2.436,
                    0.820,
                    -0.930,
                    0.30,
                    0.18,
                ],
                "row_space": 96.520,
                "skip_row_width": 0.00,
                "plants_per_meter": 10,
                "cultivar_parameters": [
                    0,
                    0.050,
                    0.28,
                    0.012,
                    0.50,
                    1.60,
                    0.010,
                    20.0,
                    0.14,
                    27.5,
                    0.3293,
                    9.482,
                    0.30,
                    0.040,
                    0.01,
                    2.8,
                    1.44,
                    0.40,
                    0.110,
                    0.40,
                    0.12,
                    17.0,
                    -2.6,
                    0.10,
                    0.15,
                    2.30,
                    1.08,
                    0.88,
                    2.30,
                    1.44,
                    0.98,
                    2.55,
                    1.50,
                    1.20,
                    0.04,
                    -31.0,
                    -52.50,
                    4.50,
                    2.50,
                    -292.0,
                    1.00,
                    54.56,
                    0.6755,
                    0.58,
                    0.42,
                    0.32,
                    0.08,
                    5.0,
                    1.48,
                    8.0,
                    0.80,
                ],
                "soil": {
                    "initial": [
                        {
                            "ammonium_nitrogen": 13.50,
                            "nitrate_nitrogen": 20.00,
                            "organic_matter": 1.200,
                            "water": 90,
                        },
                        {
                            "ammonium_nitrogen": 13.50,
                            "nitrate_nitrogen": 16.00,
                            "organic_matter": 1.000,
                            "water": 95,
                        },
                        {
                            "ammonium_nitrogen": 9.000,
                            "nitrate_nitrogen": 12.00,
                            "organic_matter": 0.800,
                            "water": 95,
                        },
                        {
                            "ammonium_nitrogen": 9.000,
                            "nitrate_nitrogen": 12.00,
                            "organic_matter": 0.600,
                            "water": 95,
                        },
                        {
                            "ammonium_nitrogen": 6.000,
                            "nitrate_nitrogen": 5.600,
                            "organic_matter": 0.000,
                            "water": 90,
                        },
                        {
                            "ammonium_nitrogen": 6.000,
                            "nitrate_nitrogen": 5.600,
                            "organic_matter": 0.000,
                            "water": 85,
                        },
                        {
                            "ammonium_nitrogen": 0.000,
                            "nitrate_nitrogen": 5.600,
                            "organic_matter": 0.000,
                            "water": 80,
                        },
                        {
                            "ammonium_nitrogen": 0.000,
                            "nitrate_nitrogen": 5.600,
                            "organic_matter": 0.000,
                            "water": 75,
                        },
                        {
                            "ammonium_nitrogen": 0.000,
                            "nitrate_nitrogen": 0.000,
                            "organic_matter": 0.000,
                            "water": 75,
                        },
                        {
                            "ammonium_nitrogen": 0.000,
                            "nitrate_nitrogen": 0.000,
                            "organic_matter": 0.000,
                            "water": 75,
                        },
                        {
                            "ammonium_nitrogen": 0.000,
                            "nitrate_nitrogen": 0.000,
                            "organic_matter": 0.000,
                            "water": 70,
                        },
                        {
                            "ammonium_nitrogen": 0.000,
                            "nitrate_nitrogen": 0.000,
                            "organic_matter": 0.000,
                            "water": 70,
                        },
                        {
                            "ammonium_nitrogen": 0.000,
                            "nitrate_nitrogen": 0.000,
                            "organic_matter": 0.000,
                            "water": 70,
                        },
                        {
                            "ammonium_nitrogen": 0.000,
                            "nitrate_nitrogen": 0.000,
                            "organic_matter": 0.000,
                            "water": 70,
                        },
                    ],
                    "hydrology": {
                        "ratio_implicit": 0.75,
                        "max_conductivity": 0.002,
                        "field_capacity_water_potential": -0.300,
                        "immediate_drainage_water_potential": -0.200,
                        "layers": [
                            {
                                "depth": 62.0,
                                "air_dry": 0.2843,
                                "theta": 0.4566,
                                "alpha": 0.0010,
                                "beta": 1.4678,
                                "saturated_hydraulic_conductivity": 0.000,
                                "field_capacity_hydraulic_conductivity": 0.020,
                                "bulk_density": 1.440,
                                "clay": 60.0,
                                "sand": 20.0,
                            },
                            {
                                "depth": 201.0,
                                "air_dry": 0.2613,
                                "theta": 0.4415,
                                "alpha": 0.0018,
                                "beta": 1.4186,
                                "saturated_hydraulic_conductivity": 0.000,
                                "field_capacity_hydraulic_conductivity": 0.020,
                                "bulk_density": 1.480,
                                "clay": 55.0,
                                "sand": 30.0,
                            },
                        ],
                    },
                },
                "climate_start_date": "1984-03-31",
                "climate": [
                    {
                        "irradiation": 476.4858,
                        "tmax": 24.0,
                        "tmin": 12.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 481.02376,
                        "tmax": 22.0,
                        "tmin": 12.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 485.56172,
                        "tmax": 22.0,
                        "tmin": 11.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 489.86084,
                        "tmax": 22.0,
                        "tmin": 13.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 494.15996,
                        "tmax": 26.0,
                        "tmin": 9.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 498.45908,
                        "tmax": 38.0,
                        "tmin": 14.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 502.7582,
                        "tmax": 25.0,
                        "tmin": 14.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 506.81848,
                        "tmax": 23.0,
                        "tmin": 15.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 510.87876,
                        "tmax": 24.0,
                        "tmin": 12.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 514.93904,
                        "tmax": 22.0,
                        "tmin": 12.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 518.99932,
                        "tmax": 22.0,
                        "tmin": 11.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 523.0596,
                        "tmax": 22.0,
                        "tmin": 13.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 526.88104,
                        "tmax": 26.0,
                        "tmin": 9.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 530.70248,
                        "tmax": 38.0,
                        "tmin": 14.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 534.52392,
                        "tmax": 25.0,
                        "tmin": 14.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 538.10652,
                        "tmax": 23.0,
                        "tmin": 15.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 541.92796,
                        "tmax": 19.0,
                        "tmin": 13.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 545.51056,
                        "tmax": 23.0,
                        "tmin": 13.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 549.09316,
                        "tmax": 36.0,
                        "tmin": 13.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 552.43692,
                        "tmax": 22.0,
                        "tmin": 15.0,
                        "rain": 30.0,
                        "wind": 30.0,
                    },
                    {
                        "irradiation": 556.01952,
                        "tmax": 26.0,
                        "tmin": 13.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 559.36328,
                        "tmax": 22.0,
                        "tmin": 9.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 562.70704,
                        "tmax": 21.0,
                        "tmin": 10.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 566.0508,
                        "tmax": 20.0,
                        "tmin": 8.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 569.15572,
                        "tmax": 19.0,
                        "tmin": 11.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 572.49948,
                        "tmax": 20.0,
                        "tmin": 8.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 575.6044,
                        "tmax": 24.0,
                        "tmin": 6.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 578.47048,
                        "tmax": 31.0,
                        "tmin": 7.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 581.5754,
                        "tmax": 22.0,
                        "tmin": 13.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 584.44148,
                        "tmax": 24.0,
                        "tmin": 9.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 587.5464,
                        "tmax": 23.0,
                        "tmin": 9.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 590.17364,
                        "tmax": 28.0,
                        "tmin": 11.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 593.03972,
                        "tmax": 39.0,
                        "tmin": 12.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 595.9058,
                        "tmax": 27.0,
                        "tmin": 19.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 598.53304,
                        "tmax": 25.0,
                        "tmin": 16.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 601.16028,
                        "tmax": 21.0,
                        "tmin": 15.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 603.78752,
                        "tmax": 30.0,
                        "tmin": 11.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 606.17592,
                        "tmax": 31.0,
                        "tmin": 12.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 608.80316,
                        "tmax": 24.0,
                        "tmin": 15.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 611.19156,
                        "tmax": 25.0,
                        "tmin": 14.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 613.34112,
                        "tmax": 27.0,
                        "tmin": 10.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 615.72952,
                        "tmax": 29.0,
                        "tmin": 10.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 618.11792,
                        "tmax": 37.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 620.26748,
                        "tmax": 45.0,
                        "tmin": 12.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 622.41704,
                        "tmax": 26.0,
                        "tmin": 15.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 624.5666,
                        "tmax": 27.0,
                        "tmin": 13.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 626.47732,
                        "tmax": 27.0,
                        "tmin": 10.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 628.38804,
                        "tmax": 31.0,
                        "tmin": 16.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 630.29876,
                        "tmax": 33.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 632.20948,
                        "tmax": 30.0,
                        "tmin": 19.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 634.1202,
                        "tmax": 31.0,
                        "tmin": 16.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 635.79208,
                        "tmax": 32.0,
                        "tmin": 12.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 637.7028,
                        "tmax": 32.0,
                        "tmin": 14.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 639.37468,
                        "tmax": 34.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 640.80772,
                        "tmax": 31.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 642.4796,
                        "tmax": 38.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 643.91264,
                        "tmax": 35.0,
                        "tmin": 21.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 645.34568,
                        "tmax": 27.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 646.77872,
                        "tmax": 27.0,
                        "tmin": 14.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 648.21176,
                        "tmax": 31.0,
                        "tmin": 14.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 649.40596,
                        "tmax": 31.0,
                        "tmin": 14.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 650.839,
                        "tmax": 28.0,
                        "tmin": 14.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 652.0332,
                        "tmax": 27.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 652.98856,
                        "tmax": 32.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 654.18276,
                        "tmax": 28.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 655.13812,
                        "tmax": 28.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 656.33232,
                        "tmax": 29.0,
                        "tmin": 14.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 657.28768,
                        "tmax": 30.0,
                        "tmin": 16.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 658.0042,
                        "tmax": 30.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 658.95956,
                        "tmax": 32.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 659.67608,
                        "tmax": 34.0,
                        "tmin": 21.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 660.3926,
                        "tmax": 31.0,
                        "tmin": 19.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 661.10912,
                        "tmax": 30.0,
                        "tmin": 16.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 661.82564,
                        "tmax": 30.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 662.30332,
                        "tmax": 29.0,
                        "tmin": 15.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 662.781,
                        "tmax": 28.0,
                        "tmin": 16.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 663.25868,
                        "tmax": 30.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 663.73636,
                        "tmax": 30.0,
                        "tmin": 16.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 664.21404,
                        "tmax": 29.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 664.45288,
                        "tmax": 29.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 664.69172,
                        "tmax": 29.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 664.93056,
                        "tmax": 27.0,
                        "tmin": 21.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 665.1694,
                        "tmax": 29.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 665.40824,
                        "tmax": 29.0,
                        "tmin": 16.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 665.40824,
                        "tmax": 31.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 665.40824,
                        "tmax": 32.0,
                        "tmin": 16.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 665.40824,
                        "tmax": 31.0,
                        "tmin": 15.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 665.40824,
                        "tmax": 30.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 665.1694,
                        "tmax": 30.0,
                        "tmin": 19.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 665.1694,
                        "tmax": 30.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 664.93056,
                        "tmax": 29.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 664.69172,
                        "tmax": 29.0,
                        "tmin": 16.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 664.45288,
                        "tmax": 30.0,
                        "tmin": 19.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 663.9752,
                        "tmax": 30.0,
                        "tmin": 21.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 663.49752,
                        "tmax": 31.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 663.25868,
                        "tmax": 33.0,
                        "tmin": 21.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 662.54216,
                        "tmax": 33.0,
                        "tmin": 19.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 662.06448,
                        "tmax": 31.0,
                        "tmin": 22.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 661.5868,
                        "tmax": 30.0,
                        "tmin": 19.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 660.87028,
                        "tmax": 29.0,
                        "tmin": 19.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 660.15376,
                        "tmax": 30.0,
                        "tmin": 19.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 659.43724,
                        "tmax": 29.0,
                        "tmin": 19.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 658.72072,
                        "tmax": 30.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 657.76536,
                        "tmax": 30.0,
                        "tmin": 19.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 657.04884,
                        "tmax": 31.0,
                        "tmin": 15.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 656.09348,
                        "tmax": 32.0,
                        "tmin": 16.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 655.13812,
                        "tmax": 30.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 654.18276,
                        "tmax": 31.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 652.98856,
                        "tmax": 33.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 651.79436,
                        "tmax": 35.0,
                        "tmin": 16.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 650.839,
                        "tmax": 32.0,
                        "tmin": 16.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 649.6448,
                        "tmax": 31.0,
                        "tmin": 22.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 648.21176,
                        "tmax": 31.0,
                        "tmin": 19.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 647.01756,
                        "tmax": 31.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 645.82336,
                        "tmax": 31.0,
                        "tmin": 19.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 644.39032,
                        "tmax": 31.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 642.95728,
                        "tmax": 31.0,
                        "tmin": 21.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 641.52424,
                        "tmax": 32.0,
                        "tmin": 19.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 639.85236,
                        "tmax": 32.0,
                        "tmin": 19.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 638.41932,
                        "tmax": 33.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 636.74744,
                        "tmax": 32.0,
                        "tmin": 21.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 635.07556,
                        "tmax": 31.0,
                        "tmin": 19.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 633.40368,
                        "tmax": 31.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 631.7318,
                        "tmax": 32.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 630.05992,
                        "tmax": 32.0,
                        "tmin": 19.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 628.1492,
                        "tmax": 32.0,
                        "tmin": 19.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 626.23848,
                        "tmax": 31.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 624.32776,
                        "tmax": 31.0,
                        "tmin": 15.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 622.41704,
                        "tmax": 31.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 620.50632,
                        "tmax": 32.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 618.35676,
                        "tmax": 33.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 616.44604,
                        "tmax": 32.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 614.29648,
                        "tmax": 32.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 612.14692,
                        "tmax": 32.0,
                        "tmin": 21.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 609.99736,
                        "tmax": 31.0,
                        "tmin": 22.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 607.8478,
                        "tmax": 33.0,
                        "tmin": 19.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 605.4594,
                        "tmax": 31.0,
                        "tmin": 22.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 603.071,
                        "tmax": 33.0,
                        "tmin": 21.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 600.92144,
                        "tmax": 34.0,
                        "tmin": 19.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 598.2942,
                        "tmax": 31.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 595.9058,
                        "tmax": 31.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 593.5174,
                        "tmax": 32.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 590.89016,
                        "tmax": 31.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 588.50176,
                        "tmax": 31.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 585.87452,
                        "tmax": 31.0,
                        "tmin": 19.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 583.24728,
                        "tmax": 30.0,
                        "tmin": 19.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 580.62004,
                        "tmax": 31.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 577.9928,
                        "tmax": 31.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 575.12672,
                        "tmax": 33.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 572.26064,
                        "tmax": 34.0,
                        "tmin": 14.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 569.6334,
                        "tmax": 32.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 566.76732,
                        "tmax": 31.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 563.90124,
                        "tmax": 32.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 560.79632,
                        "tmax": 32.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 557.93024,
                        "tmax": 35.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 554.82532,
                        "tmax": 32.0,
                        "tmin": 19.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 551.95924,
                        "tmax": 31.0,
                        "tmin": 19.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 548.85432,
                        "tmax": 31.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 545.7494,
                        "tmax": 32.0,
                        "tmin": 19.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 542.64448,
                        "tmax": 33.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 539.30072,
                        "tmax": 33.0,
                        "tmin": 16.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 536.1958,
                        "tmax": 32.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 532.85204,
                        "tmax": 32.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 529.74712,
                        "tmax": 33.0,
                        "tmin": 14.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 526.40336,
                        "tmax": 35.0,
                        "tmin": 16.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 523.0596,
                        "tmax": 38.0,
                        "tmin": 15.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 519.71584,
                        "tmax": 32.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 516.13324,
                        "tmax": 31.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 512.78948,
                        "tmax": 32.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 509.20688,
                        "tmax": 32.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 505.86312,
                        "tmax": 31.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 502.28052,
                        "tmax": 31.0,
                        "tmin": 17.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 498.69792,
                        "tmax": 31.0,
                        "tmin": 16.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 495.11532,
                        "tmax": 33.0,
                        "tmin": 16.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 491.53272,
                        "tmax": 33.0,
                        "tmin": 15.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 487.71128,
                        "tmax": 33.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 484.12868,
                        "tmax": 39.0,
                        "tmin": 24.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 480.30724,
                        "tmax": 32.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 476.4858,
                        "tmax": 32.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 472.9032,
                        "tmax": 32.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 469.08176,
                        "tmax": 32.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 465.02148,
                        "tmax": 32.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 461.20004,
                        "tmax": 32.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 457.3786,
                        "tmax": 26.0,
                        "tmin": 15.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 453.31832,
                        "tmax": 25.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 449.49688,
                        "tmax": 28.0,
                        "tmin": 14.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 445.4366,
                        "tmax": 30.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 441.37632,
                        "tmax": 32.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 437.55488,
                        "tmax": 32.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 433.4946,
                        "tmax": 32.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 429.19548,
                        "tmax": 32.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 425.1352,
                        "tmax": 32.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 421.07492,
                        "tmax": 32.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 416.7758,
                        "tmax": 26.0,
                        "tmin": 15.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 412.71552,
                        "tmax": 25.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 408.4164,
                        "tmax": 28.0,
                        "tmin": 14.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 404.11728,
                        "tmax": 30.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 400.057,
                        "tmax": 28.0,
                        "tmin": 14.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 395.75788,
                        "tmax": 30.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 391.45876,
                        "tmax": 32.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 386.9208,
                        "tmax": 32.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 382.62168,
                        "tmax": 32.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 378.32256,
                        "tmax": 32.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 374.02344,
                        "tmax": 32.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 369.48548,
                        "tmax": 32.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 364.94752,
                        "tmax": 26.0,
                        "tmin": 15.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 360.6484,
                        "tmax": 25.0,
                        "tmin": 18.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 356.11044,
                        "tmax": 28.0,
                        "tmin": 14.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                    {
                        "irradiation": 351.57248,
                        "tmax": 30.0,
                        "tmin": 20.0,
                        "rain": 0.0,
                        "wind": 180.0,
                    },
                ],
                "agricultural_inputs": [
                    {"type": "fertilization", "date": "1984-04-01", "ammonium": 150.0},
                    {"type": "irrigation", "date": "1984-06-22", "amount": 89.000},
                    {"type": "irrigation", "date": "1984-07-12", "amount": 104.000},
                    {"type": "irrigation", "date": "1984-07-26", "amount": 104.000},
                    {"type": "irrigation", "date": "1984-08-08", "amount": 98.000},
                    {"type": "irrigation", "date": "1984-08-22", "amount": 72.000},
                    {
                        "type": "defoliation prediction",
                        "date": "1984-09-15",
                        "method": 85,
                    },
                ],
            }
        )
    )
    return test


@fixture
def sim(test_json) -> Simulation:
    return run(test_json)
